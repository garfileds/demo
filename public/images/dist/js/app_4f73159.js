webpackJsonp([10],{"+2L+":function(e,n,t){"use strict";function i(e,n,t){!function i(o){o>=e.length?t():e[o]?n(e[o],o,function(e){if(e)return t(e);i(o+1)}):i(o+1)}(0)}n.a=i},"/mBw":function(e,n){},0:function(e,n){},"0DZq":function(e,n){},1:function(e,n){},"7/zs":function(e,n){},"70Cq":function(e,n,t){"use strict";t.d(n,"e",function(){return r}),t.d(n,"c",function(){return s}),t.d(n,"a",function(){return u}),t.d(n,"d",function(){return c}),t.d(n,"b",function(){return d}),t.d(n,"h",function(){return l}),t.d(n,"f",function(){return p}),t.d(n,"g",function(){return f});var i=t("pFYg"),o=t.n(i),a=t("mvHQ"),r=(t.n(a),function(e,n){for(var t=n.parentNode;null!==t;){if(t===e)return!0;t=t.parentNode}return!1}),s=function(e,n){return n=n||"yy/mm/dd",n.replace(/(yy)|(mm)|(dd)/g,function(n,t,i,o){return t?e.getFullYear():i?e.getMonth()+1:o?e.getDate():void 0})},u=function(){var e=["00","33","66","99","CC","FF"],n=void 0,t=void 0,i=void 0,o=e.length-1,a=[];for(n=o;n>=0;n--)for(t=o;t>=0;t--)for(i=o;i>=0;i--)a.push("#"+e[n]+e[t]+e[i]);return a.shift(),a.shift(),a.unshift("#3366CC","#33CC00","#FFFF00","#CC6600","#CC0000"),a},c=function(e,n){var t=n.parentNode,i=document.querySelectorAll(e);for(i=Array.prototype.slice.call(i,0);null!==t;){if(i.indexOf(t)>-1)return t;t=t.parentNode}return!1},l=function(e,n){return n===document.querySelector(e)||c(e,n)},d=function(e,n){"string"==typeof e&&(e=document.querySelector(e)),n=n||"formData";var t=e.elements.length,i=null,o=[],a={},r=void 0,s=void 0,u=void 0,c=void 0,l=void 0;for(u=0;u<t;u++)switch(i=e.elements[u],i.type){case"select-one":case"select-multiple":if(i.name.length)for(c=0,r=i.options.length;c<r;c++)l=i.options[c],l.selected&&(s="",s=l.hasAttribute?l.hasAttribute("value")?l.value:l.text:l.hasAttribute.value.specified?l.value:l.text,a[i.name]=s.trim(),o.push(encodeURIComponent(i.name)+"="+encodeURIComponent(s)));break;case void 0:case"file":case"submit":case"reset":case"button":break;case"radio":case"checkbox":default:i.name.length&&(s=i.value,a[i.name]=s.trim(),o.push(encodeURIComponent(i.name)+"="+encodeURIComponent(s.trim())))}return"formData"===n?o.join("&"):a},p=function(e){if(void 0===e||null===e)return!0;if("function"==typeof e||"number"==typeof e||"boolean"==typeof e||"[object Date]"===Object.prototype.toString.call(e))return!1;if(Array.isArray(e)||"string"==typeof e)return 0===e.length;if("object"===(void 0===e?"undefined":o()(e))){for(var n in e)if(e.hasOwnProperty(n))return!1;return!0}return!1},f=function(e){return"[object Object]"===Object.prototype.toString.call(e)}},"8uhx":function(e,n){},"9A8w":function(e,n,t){e.exports=t.p+"images/all-devices_medium@1x_963155e.png"},NHnr:function(e,n,t){"use strict";function i(){if(!q.length)return void(z=setTimeout(i,Y));var e=q.slice(0,1);e.forEach(function(e){var n,t;e.isProcessing=!0,!e.planStr&&(n=u(X.state.plans),t=O()(n,2),e.planStr=t[0],e.commitIdTemp=t[1])}),Object(j.a)(e,o,function(e){var n=void 0;if(e){if(n="sync"===e.type?"error":"warn",console[n]("type: "+e.type+"\nmessage: "+e.message),"sync"===e.type)return}else q.shift();z=setTimeout(i,Y)})}function o(e,n,t){var i={update:e.update,remove:e.remove};h.default.http.post(U,{commit_id:$,type:"local",update_info:i}).then(function(i){var o=void 0,a=void 0,s=void 0;if("ok"===i.body.code)e.commitIdTemp!==i.body.commit_id?t({type:"sync",index:n,message:"expected synchronization during local update since accepting ok response"}):(F=e.planStr,$=e.commitIdTemp,t());else if("not synchronized"===i.body.code)return a=i.body.plans,s=r(a,X.state.plans),o=i.body.commit_id,h.default.http.post(U,{type:"global",commit_id:o,update_info:s}).then(function(e){if(200===e.status){var i=u(s),o=O()(i,2),a=o[0],r=o[1];r!==e.body.commit_id?t({type:"sync",index:n,message:"expected synchronization after merge during global update"}):(F=a,$=r,X.commit("coverPlans",s),q=[],t())}},function(){t({type:"network",index:n,message:"bad network during global update"})})},function(){t({type:"network",index:n,message:"bad network during global update"})})}function a(){return{isProcessing:!1,update:{},remove:[]}}function r(e,n){for(var t=[],i=R(e),o=R(n),a=0,r=0,u=i.length,c=o.length;a<u&&r<c;)i[a].id===o[r].id?(s(i[a],o[r]),t.push(i[a]),a++,r++):i[a].id>o[r].id?(t.push(o[r]),r++):(t.push(i[a]),a++);if(a===u){var l;t=(l=t).concat.apply(l,C()(o.slice(r,c)))}else{var d;t=(d=t).concat.apply(d,C()(i.slice(a,u)))}return t}function s(e,n){P()(n).forEach(function(t){Object(E.f)(e[t])?e[t]=n[t]:Object(E.g)(n[t])&&s(e[t],n[t])})}function u(e){var n={_id:"",id:"",title:"",bg_image:"",color:"rgb(255, 204, 51)",progress_color:"#fff",progress:{days:21,start_day:"",done:[],marked:[]},status:"",pokeman_id:"",pokeman_name:"",pokeman_img:"",user_id:""},t="";e.forEach(function(e){var i=k()({},n,e);t+=y()(i)});var i=L(t);return[t,i]}function c(e,n){var t=void 0;if((!q.length||q[q.length-1].isProcessing)&&q.push(a()),t=q[q.length-1],"delete"===e)return t.remove.push(n);var i=t.update[n.planId];i||(i=t.update[n.planId]={}),"update"===e?k()(i,n.updateInfo):"done"===e&&k()(i,{"progress.done":n.done,status:n.status})}function l(e){t("/mBw")}function d(e){t("7/zs")}function p(e,n){var t=["/userRegister","/userLogin"];return"/home"===e.path&&t.indexOf(n.path)>-1}function f(e,n,t){var i={"/userRegister":"/","/userLogin":"/","/planAdd":["/home","/planDetail"],"/setting":"/home","/pokemen":"/home","/planEdit":"/planDetail","/planDetail":"/home"},o=P()(i),a=n.path,r=e.path,s=[a,r].map(function(e){return e.replace(/^((\/planEdit)|(\/planDetail))\/.+$/,function(e,n){return n})}),u=O()(s,2);a=u[0],r=u[1],o.indexOf(a)>-1&&i[a].indexOf(r)>-1?M.commit("changeTransitionName","slide-right"):o.indexOf(r)>-1&&i[r].indexOf(a)>-1?M.commit("changeTransitionName","slide-left"):"/"===r?M.commit("changeTransitionName",""):M.commit("changeTransitionName","slide-up"),h.default.nextTick(function(){t()})}function m(e){t("0DZq")}Object.defineProperty(n,"__esModule",{value:!0});var h=(t("cp28"),t("8uhx"),t("/5sW")),g=t("ORbq"),v=t("pumu"),b=t("mvHQ"),y=t.n(b),_=t("woOf"),k=t.n(_),w=t("Gu7T"),C=t.n(w),T=t("2aIq"),x=t.n(T),S=t("fZjL"),P=t.n(S),I=t("d7EF"),O=t.n(I),A=t("BO1k"),N=t.n(A),D=t("NYxO"),E=t("70Cq"),L=t("AJcs"),R=(t("hKoQ").Promise,t("2iM5"),t("zM1N")),j=t("+2L+");h.default.use(D.a),h.default.use(g.a);var q=[],F=void 0,$=void 0,z=0,U="/api/plans",Y=500,X=new D.a.Store({state:{needInit:!0,needCache:!0,transitionName:"",plansDoneShow:!1,queueIsRunning:!1,loading:{isLoading:!1,tip:""},plans:[],pokemen:[],user:{}},getters:{plansDone:function(e){return e.plans.filter(function(e){return"done"===e.status})},plansIng:function(e){return e.plans.filter(function(e){return"ing"===e.status})},pokemenCollected:function(e){var n=[],t=!0,i=!1,o=void 0;try{for(var a,r=N()(e.plans);!(t=(a=r.next()).done);t=!0){var s=a.value;"done"===s.status&&n.push(s.pokeman_id)}}catch(e){i=!0,o=e}finally{try{!t&&r.return&&r.return()}finally{if(i)throw o}}return e.pokemen.filter(function(e){return n.indexOf(e.id)>-1})}},mutations:{initPlans:function(e,n){e.plans=n||[],e.needInit=!1,console.log("[done] plan init")},initPokemen:function(e,n){e.pokemen=n||[],console.log("[done] pokemen init")},changePlansDoneShow:function(e,n){e.plansDoneShow=n},changeNeedInit:function(e,n){e.needInit=n},changeLoading:function(e,n){e.loading.isLoading=n.isLoading,e.loading.tip=n.tip||""},changeCache:function(e,n){e.needCache=n},changeTransitionName:function(e,n){e.transitionName=n},coverPlans:function(e,n){e.plans=n||[]},addPlan:function(e,n){e.plans.push(n.plan);var t=u(e.plans),i=O()(t,2);F=i[0],$=i[1]},updatePlan:function(e,n){for(var t=0,i=void 0;t<e.plans.length;){if(e.plans[t].id===n.planId){i=e.plans[t],P()(n.updateInfo).forEach(function(e){i[e]=n.updateInfo[e]});break}t++}c("update",n)},deletePlan:function(e,n){e.plans=e.plans.filter(function(e){return e.id!==n.planId}),c("delete",n.planId)},donePlan:function(e,n){var t=void 0,i=void 0;t=e.plans.filter(function(e){return e.id===n.planId})[0],i=t.progress.done.indexOf(n.day),-1===i?t.progress.done.push(n.day):t.progress.done.splice(i,1),t.progress.done.length===t.progress.marked.length?t.status="done":t.status="ing",c("done",{planId:n.planId,status:t.status,done:t.progress.done})},initUser:function(e,n){e.user.nickname=n.nickname,e.user.email=n.email,e.user.id=n._id},clear:function(e){e.needInit=!0,e.user={},e.plans=[]}},actions:{getPlans:function(e){var n=e.commit;return h.default.http.get("/api/plans").then(function(e){clearTimeout(z);var t=e.body;n("initPlans",t);var i=u(t),o=O()(i,2);F=o[0],$=o[1]})},getPokemen:function(e){var n=e.commit;return h.default.http.get("/api/pokemen").then(function(e){n("initPokemen",e.body)})},syncPlansOnce:function(e,n){x()(e);var t=R(q);q=[a()],Object(j.a)(t,o,n)},stopSyncTimer:function(){clearTimeout(z)},startSyncTimer:function(){i()}}}),M=X,B=t("/ocq"),H={name:"welcomeSlide"},G=function(){var e=this,n=e.$createElement;e._self._c;return e._m(0)},Z=[function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("section",[i("div",{staticClass:"stage"},[i("img",{staticClass:"response-img stage__item",attrs:{src:t("9A8w"),alt:"多端适用",srcset:t("9A8w")+" 720w, "+t("bTl6")+" 1440w, "+t("oSyX")+" 2048w",sizes:"100vw"}})]),e._v(" "),i("p",{staticClass:"description"},[e._v("随时随地使用...")]),e._v(" "),i("div",{staticClass:"bar"})])}],Q={render:G,staticRenderFns:Z},V=Q,J=t("VU/8"),W=l,K=J(H,V,!1,W,"data-v-4f05dc9b",null),ee=K.exports,ne={name:"welcome",components:{welcomeSlide:ee}},te=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("main",{staticClass:"l-wrap"},[t("welcomeSlide",{staticClass:"l-slide"}),e._v(" "),t("section",{staticClass:"c-button-group"},[t("router-link",{staticClass:"c-button l-button--full",attrs:{to:"/userRegister"}},[e._v("创建账户")]),e._v(" "),t("router-link",{staticClass:"c-button l-button--full button--login",attrs:{to:"/userLogin"}},[e._v("登录")])],1)],1)},ie=[],oe={render:te,staticRenderFns:ie},ae=oe,re=t("VU/8"),se=d,ue=re(ne,ae,!1,se,"data-v-5f3e735a",null),ce=ue.exports;h.default.use(B.a);var le=new B.a({mode:"hash",routes:[{path:"/",component:ce,meta:{keepAlive:!0}},{path:"/userLogin",component:function(){return Promise.all([t.e(0),t.e(6)]).then(t.bind(null,"+Nj0"))},meta:{keepAlive:!0}},{path:"/userRegister",component:function(){return Promise.all([t.e(0),t.e(8)]).then(t.bind(null,"Dj9F"))},meta:{keepAlive:!0}},{path:"/setting",component:function(){return Promise.all([t.e(0),t.e(5)]).then(t.bind(null,"77Zy"))},meta:{keepAlive:!0}},{path:"/pokemen",component:function(){return Promise.all([t.e(0),t.e(4)]).then(t.bind(null,"ND16"))},meta:{keepAlive:!0}},{path:"/home",component:function(){return Promise.all([t.e(0),t.e(2)]).then(t.bind(null,"LqM4"))},meta:{keepAlive:!0}},{path:"/planAdd",component:function(){return Promise.all([t.e(0),t.e(1)]).then(t.bind(null,"lN2s"))}},{path:"/planDetail/:id",component:function(){return Promise.all([t.e(0),t.e(3)]).then(t.bind(null,"Dn0s"))}},{path:"/planEdit/:id",component:function(){return Promise.all([t.e(0),t.e(7)]).then(t.bind(null,"qyHG"))}}]});le.beforeEach(function(e,n,t){p(e,n)&&(M.commit("changeCache",!1),h.default.nextTick(function(){M.commit("changeCache",!0)})),f(e,n,t)});var de=le,pe=t("Dd8w"),fe=t.n(pe),me={name:"App",data:function(){return{isRightSlide:!1,startScreenX:0,startScreenY:0}},computed:fe()({},Object(D.e)(["loading","plans","needCache","transitionName"])),methods:{onTouchstart:function(e){var n=void 0;1===e.changedTouches.length&&(n=e.changedTouches[0],this.isRightSlide=!1,this.startScreenX=n.screenX,this.startScreenY=n.screenY)},onTouchmove:function(e){1===e.changedTouches.length&&this._isRightSlide(e.changedTouches[0])&&e.preventDefault()},onTouchend:function(e){1===e.changedTouches.length&&this._isRightSlide(e.changedTouches[0])&&this.$router.go(-1)},_isRightSlide:function(e){var n=e.screenX-this.startScreenX,t=Math.abs(e.screenY-this.startScreenY);return n>=50&&n>t}}},he=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{attrs:{id:"app"},on:{touchstart:e.onTouchstart,touchmove:e.onTouchmove,touchend:e.onTouchend}},[t("transition",{attrs:{name:e.transitionName}},[e.needCache?t("keep-alive",[e.$route.meta.keepAlive?t("router-view",{staticClass:"l-absolute"}):e._e()],1):e._e()],1),e._v(" "),t("transition",{attrs:{name:e.transitionName}},[e.$route.meta.keepAlive?e._e():t("router-view",{staticClass:"l-absolute"})],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.loading.isLoading,expression:"loading.isLoading"}],staticClass:"c-loader l-loader"},[e._m(0),e._v(" "),t("p",[e._v(e._s(e.loading.tip))])])],1)},ge=[function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"c-loader__content pacman"},[t("div"),e._v(" "),t("div"),e._v(" "),t("div"),e._v(" "),t("div"),e._v(" "),t("div")])}],ve={render:he,staticRenderFns:ge},be=ve,ye=t("VU/8"),_e=m,ke=ye(me,be,!1,_e,"data-v-7e6ca97d",null),we=ke.exports;h.default.use(g.a),h.default.config.productionTip=!1,h.default.config.devtools=!0,new h.default({el:"#app",render:function(e){return e(we)},router:de,store:M,created:function(){Object(v.b)(de)},mounted:function(){document.getElementById("appTemp").style.display="none"}})},bTl6:function(e,n,t){e.exports=t.p+"images/all-devices_medium@2x_5b4c3f7.png"},cp28:function(e,n){},oSyX:function(e,n,t){e.exports=t.p+"images/all-devices_xlarge@2x_3b7e33c.png"},pumu:function(e,n,t){"use strict";function i(e){a.default.http.interceptors.push(function(n,t){var i=this||e.app,o="["+n.method+"] "+n.url,a=r.hasOwnProperty(o);a&&i.$store.commit({type:"changeLoading",isLoading:!0,tip:r[o].tip||""}),t(function(e){return a&&i.$store.commit({type:"changeLoading",isLoading:!1}),401!==e.status||s?e:(s=!0,alert("验证失败，请重新登录。"),i.$router.push("/"))})})}function o(e){a.default.http.headers.common.Authorization=e?"Bearer "+e:""}n.b=i,n.a=o;var a=t("/5sW"),r={"[GET] /api/plans":{},"[DELETE] /user/token":{tip:"正在登出，我们会保存你最近的更改..."},"[GET] /api/pokemen":{}},s=!1}},["NHnr"]);